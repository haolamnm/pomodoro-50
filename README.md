Refactor the code structure to make it more modular and reusable.

